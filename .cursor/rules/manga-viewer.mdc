---
description: 漫画ビューワプロジェクトの設計原則と設定
globs:
  - "**/*.js"
  - "**/*.html"
  - "**/*.css"
alwaysAdd: true
---

# 漫画ビューワプロジェクト設定

## 開発環境
- Live Serverを使用してローカル開発を行う
- ポート番号: 5502（固定）
- アクセスURL: http://localhost:5502/index.html
- VS Code設定: `.vscode/settings.json` で管理

## プロジェクト仕様
- 日本式漫画ビューワ（右から左へ読む）
- 画像ファイル: 001.png～006.png（9:16の縦長画像）
- バニラJS + HTML + CSSで実装（フレームワーク不使用）

## 実装済み機能
- 単ページ/見開き表示モード
- 日本式ページめくり（右→左）
- キーボード、マウス、タッチ操作対応
- ズーム機能（50%～300%）
- サムネイル一覧（ページジャンプ）
- ダークモード（LocalStorage保存）
- 全画面表示
- しおり機能（最後に読んだページを記憶）
- 設定パネル（アニメーション速度、背景色、自動ページめくり）
- レスポンシブデザイン（デスクトップ、タブレット、モバイル対応）

## 重要な設計原則【日本式漫画の読み方】

### ページの並び順
- **右から左へ読む**のが基本
- 単ページ: 1→2→3→4→5→6
- 見開き: [2,1]→[4,3]→[6,5]（右ページが先、左ページが後）

### UI要素の方向性
- **進捗バー**: 右から左へ進行（`direction: rtl`）
- **サムネイル一覧**: 右から左へ並ぶ（`direction: rtl`）
- **ボタン配置**: 左側=次ページボタン、右側=前ページボタン
- **見開き表示**: `flex-direction: row-reverse` で右ページを先に表示

### ページ遷移ロジック
- **キーボード**: 左矢印/スペース=次、右矢印=前
- **マウスクリック**: 左半分=次、右半分=前
- **スワイプ**: 左から右へスワイプ（deltaX > 0）=次、右から左へスワイプ（deltaX < 0）=前
- **見開きモード**: 2ページずつ進む/戻る
- **重要**: タッチデバイスでは`touchend`の後に`click`イベントも発火するため、`touchHandled`フラグでクリックイベントを抑制

### ボタンの非活性化ルール
- 最初のページでは「前のページ」ボタンを非活性化（`opacity: 0.3`, `disabled`属性）
- 見開きモードで最後のページペアを表示中は「次のページ」ボタンを非活性化
- `canGoNext()` と `canGoPrev()` で判定

## コード規約
- クラスベースのアプリケーション構造（MangaViewerクラス）
- LocalStorageで設定を永続化（`mangaViewer_settings`, `mangaViewer_bookmark`）
- CSS変数でテーマ管理（`--bg-color-light`, `--bg-color-dark`等）
- レスポンシブブレークポイント: 1024px, 768px

## 注意事項
- 画像は9:16の縦長比率を想定
- モバイル（767px以下）では見開きモードは自動的に単ページ表示に切り替わる
- ズーム中はクリックでのページ遷移を無効化
- パネル（サムネイル/設定）が開いている時はキーボード操作を無効化
